---
title: Random fun (xoroshiro)
published: true
tags: random c++ math quote
---
> Le hasard souvent fait plus que la science. - [_Proverbe FranÃ§ais_](https://citations.ouest-france.fr/citation-proverbe-francais/hasard-souvent-fait-science-80598.html)

![caption](https://thompsonsed.co.uk/wp-content/uploads/2019/03/prng_perf.jpg) 

### [xoroshiro128+](http://xoroshiro.di.unimi.it/) (XOR/shift/rotate) / [wikipedia](https://en.wikipedia.org/wiki/Xorshift#xorshift.2B)

> The lowest bits of the output generated by xoroshiro128+ have low quality. The authors of xoroshiro128+ acknowledge that it does not pass all statistical tests, stating: We suggest to use its upper bits for floating-point generation.

- [What is performance-wise the best way to generate random bools?]( https://stackoverflow.com/a/35358644/51386)

{% highlight cpp %}
#include <random>

random_device rd;
/* The state must be seeded so that it is not everywhere zero. */
uint64_t s[2] = { (uint64_t(rd()) << 32) ^ (rd()),
    (uint64_t(rd()) << 32) ^ (rd()) };

static inline uint64_t rotl(const uint64_t x, int k) {
	return (x << k) | (x >> (64 - k));
}

uint64_t xoroshiro128plus(void) {
    uint64_t x = s[0];
    uint64_t const y = s[1];
    s[0] = y;
    x ^= x << 23; // a
    s[1] = x ^ y ^ (x >> 17) ^ (y >> 26); // b, c
    return s[1] + y;
}
{% endhighlight %}

  see also:
- [Pseudo-random number generation (C++11)](http://en.cppreference.com/w/cpp/numeric/random)
- [Random number generators for C++ performance tested](https://thompsonsed.co.uk/random-number-generators-for-c-performance-tested)
- [Vectorizing random number generators for greater speed](https://lemire.me/blog/2018/06/07/vectorizing-random-number-generators-for-greater-speed-pcg-and-xorshift128-avx-512-edition/)