---
published: true
title: Systemd
tags: init system systemd linux-system service
---
> we can create all sockets for all daemons in one step in the init system, and then in a second step run all daemons at once. - [Rethinking PID 1](http://0pointer.net/blog/projects/systemd) / [systemd](https://www.freedesktop.org/wiki/Software/systemd/)

`systemctl status`  
`systemctl enable/disable` => service launch on host startup  
`systemctl start/stop`     => immediate operation  


> A good metric for measuring shell script infestation of the boot process is the PID number of the first process you can start after the system is fully booted up. Boot up, log in, open a terminal, and type echo $$.


## [State: degraded](https://unix.stackexchange.com/questions/447561/systemctl-status-shows-state-degraded)
- original issue caused by apparmor not starting - [How to disable AppArmor](https://www.simplified.guide/ubuntu/remove-apparmor)
{% highlight bash %}
systemctl --failed => to list which services failed to start
{% endhighlight %}

## [Keep a process alive](https://superuser.com/questions/1119643/keep-a-process-alive-after-logging-out-from-local-not-ssh-session)
in _/etc/systemd/logind.conf_
{% highlight bash %}
KillUserProcesses=no
{% endhighlight %}

## [Update service definition](https://serverfault.com/questions/700862/do-systemd-unit-files-have-to-be-reloaded-when-modified)

{% highlight bash %}
systemctl daemon-reload
systemctl restart your-service-name
{% endhighlight %}

## Scheduled Shutdown
- [systemd/Timers](https://wiki.archlinux.org/index.php/Systemd/Timers#As_a_cron_replacement)
	- [Creating A Timer](https://linuxhint.com/cron_systemd_timer/)
    - [creating a service](https://linuxhint.com/systemd_unit_file_service/)

## [Run script after wakeup?](https://unix.stackexchange.com/questions/152039/how-to-run-a-user-script-after-systemd-wakeup/492497#492497)

## [Service](https://linuxconfig.org/how-to-create-systemd-service-unit-in-linux)

There are basically two places in the filesystem where systemd service units are installed: `/usr/lib/systemd/system` and `/etc/systemd/system`. The former path is used for services provided by installed packages, while the latter can be used by the system administrator for its own services which can override the default ones.

{% highlight bash %}
sudo cp wol.service /etc/systemd/system && sudo systemctl start wol.service
{% endhighlight %}
