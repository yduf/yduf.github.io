---
published: true
title: Docker
tags: docker
---
> Docker uses the Linux kernel and features of the kernel, like Cgroups and namespaces, to segregate processes so they can run independently as if they were running on separate system. - [What is Docker?](https://www.redhat.com/en/topics/containers/what-is-docker)

## [Exposing X11](https://stackoverflow.com/questions/44429394/x11-forwarding-of-a-gui-app-running-in-docker)

- [x11docker](https://github.com/mviereck/x11docker) - un GUI applications in Docker ?

{% highlight bash %}
export DISPLAY=:0.0
xhost +local:docker
docker run .. --env DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix
{% endhighlight %}

## [Install](https://linuxconfig.org/how-to-install-docker-on-ubuntu-20-04-lts-focal-fossa)

[Atlernative on Pi](https://dev.to/elalemanyo/how-to-install-docker-and-docker-compose-on-raspberry-pi-1mo) should work as well

{% highlight bash %}
curl -sSL https://get.docker.com | sh # install
sudo usermod -aG docker $USER         # config user permission
docker run hello-world                # test
{% endhighlight %}

Or

{% highlight bash %}
sudo apt install docker.io
# sudo systemctl unmask docker
sudo systemctl enable --now docker
sudo usermod -aG docker $LOGNAME
docker --version
{% endhighlight %}

Test that docker works
{% highlight bash %}
docker run hello-world
{% endhighlight %}

Finally check that docker is [using overlay2](https://docs.docker.com/storage/storagedriver/overlayfs-driver/)
{% highlight bash %}
docker info | grep -A 5 -i storage
{% endhighlight %}

## Convert to [overlay2 storage driver](https://docs.docker.com/storage/storagedriver/overlayfs-driver/)

> AMD recommends using 'overlay2', whose dependencies are met by the ROCm kernel - [ROCm](https://github.com/RadeonOpenCompute/ROCm-docker/blob/master/quick-start.md)

if necessary, see above.

[move docker's default /var/lib/docker to another directory](https://linuxconfig.org/how-to-move-docker-s-default-var-lib-docker-to-another-directory-on-ubuntu-debian-linux)
- need to move /var/lib/docker folder as a whole
- or pass argument to daemon

{% highlight bash %}
sudo systemctl stop docker			# stop docker
{% endhighlight %}

Edit /etc/docker/daemon.json
{% highlight json %}
{
  "storage-driver": "overlay2"
}
{% endhighlight %}

{% highlight bash %}
sudo systemctl start docker			# start docker
{% endhighlight %}

Verify that the daemon is using the overlay2 storage driver.
{% highlight bash %}
docker info
{% endhighlight %}

## [/etc/docker/daemon.json](https://docs.docker.com/engine/reference/commandline/dockerd/)

- [Dealing with dynamically created devices](https://docs.docker.com/engine/reference/commandline/create/#dealing-with-dynamically-created-devices---device-cgroup-rule) / [SO](https://stackoverflow.com/questions/24225647/docker-a-way-to-give-access-to-a-host-usb-or-serial-device) / [device allow](https://forums.docker.com/t/add-devices-to-existing-docker-container/38685/3)

## Alternatives
- [podman](https://podman.io/) -  daemonless container engine - `Simply put: alias docker=podman`
- [containerd](https://github.com/containerd/containerd) - [What is Containerd? ](https://caylent.com/what-is-containerd)
	- [nerdctl](https://github.com/containerd/nerdctl) - a Docker-compatible CLI for containerd.
- [LXC](https://news.ycombinator.com/item?id=30385580)
