---
published: true
title: Facebook Open-source Library (Folly)
tags: lib c++ benchmarking
---
>  a library of C++14 components designed with practicality and efficiency in mind. - [github](https://github.com/facebook/folly)

## [Benchmark Tool](https://github.com/facebook/folly/blob/master/folly/docs/Benchmark.md)
> Benchmark timings are not a regular random variable that fluctuates around an average. 

- `doNotOptimizeAway( yourvar)` -  prevents compiler optimizations that may interfere with benchmarking 

The first is the name of the benchmark.  
The second argument may be missing, or could be a symbolic counter. The counter dictates how many internal iteration the benchmark does.

{% highlight cpp %}
BENCHMARK(insertVectorBegin, iters) {
    vector<int> v;
    FOR_EACH_RANGE (i, 0, iters) {
      v.insert(v.begin(), 42);
    }
  }
{% endhighlight %}

## [Installation](https://github.com/facebook/folly#ubuntu-1604-lts)

Not trivial to get dependancies rigth...

{% highlight bash %}
g++  example.cc -lfollybenchmark -lfolly -lglog -lgflags -pthread -lm -lpthread -ldl -ldouble-conversion -lboost_regex -lssl -lcrypto -liberty
{% endhighlight %}

prefer to use Meson + CMake subproject + install FMT

### [FMT](https://github.com/fmtlib/fmt)
Folly relies on [fmt](https://github.com/fmtlib/fmt) which needs to be installed from source.

{% highlight bash %}
mkdir build          # Create a directory to hold the build output.
cd build
cmake ..  # Generate native build scripts.
{% endhighlight %}

### Manual setup

{% highlight bash %}
sudo apt-get install \
    g++ \
    cmake \
    libboost-all-dev \
    libevent-dev \
    libdouble-conversion-dev \
    libgoogle-glog-dev \
    libgflags-dev \
    libiberty-dev \
    liblz4-dev \
    liblzma-dev \
    libsnappy-dev \
    make \
    zlib1g-dev \
    binutils-dev \
    libjemalloc-dev \
    libssl-dev \
    pkg-config \
    libunwind-dev
{% endhighlight %}


