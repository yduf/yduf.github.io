---
published: true
title: '# lua'
tags: lua lang pico8 vscode
toc: true
---
>  a lightweight embeddable scripting language. - [Lua](https://www.lua.org/start.html) / [online](https://www.lua.org/cgi-bin/demo) / [Lua Guide](https://docs.otland.net/lua-guide/)

## [Pico-8](https://www.lexaloffle.com/dl/docs/pico-8_manual.html)

[Pico-8 lua is not standard](https://pico-8.fandom.com/wiki/Lua)
- it has some addition (`+=`, `if() oneline`, ..)
	- [`all`, `add`](https://chatgpt.com/share/68c165a1-4d0c-800d-8a0e-3f8f284da05f) - some which can be emulated on standard lua
- it lack some standard fonction (`string.*`n `table.*`) which may exist (or not in a different form).

- [z8lua](https://www.lexaloffle.com/bbs/?tid=31577) / [github](https://github.com/samhocevar/z8lua?tab=readme-ov-file#z8lua) - a fork of Lua that implements the PICO-8 dialect.
	- to install: `git clone` + `make` => z8lua binary
    - does not support require?
- [Going from Lua 5.2 to PICO-8's Lua ](https://gist.github.com/josefnpat/bfe4aaa5bbb44f572cd0)

# Lua Langage
## [Setup](https://www.geeksforgeeks.org/how-to-install-and-setup-lua-in-linux/)
{% highlight bash %}
$ sudo apt install lua5.2   # this is the closest to PICO-8 v0.2.5g
{% endhighlight %}

## Table
Table can be treated as an array (list-like) or as a key-value dictionary.

{% highlight lua %}
-- Array
t = {1, 2, 3}

-- of dictionnary: Simple object-like table
Person = {
    name = "Alice",
    age = 25
}
{% endhighlight %}

### [Appending to a table](https://chatgpt.com/share/68baa63e-c6b4-800d-8bd3-4f3bd6084300)

{% highlight lua %}
-- Array
table.insert(t, 4)

-- or assign to next index
t[#t + 1] = 5

for i, v in ipairs(t) do
    print(i, v)
end
{% endhighlight %}

{% highlight lua %}
-- for dictionnary just assign the key
Person["c"] = 3
Person.d = 4  -- shorthand for t["d"]

for k, v in pairs(Person) do
    print(k, v)
end
{% endhighlight %}


## Object / Struct
see [Meta-table]({% post_url 2023-11-14-lua-metatable-class %})


### [Operators Tutorial](https://lua-users.org/wiki/OperatorsTutorial)

# [Unit Testing](https://github.com/LewisJEllis/awesome-lua#testing)

- [Popular Lua Testing Frameworks](https://chatgpt.com/share/68c11a52-4fd0-800d-8873-69cbf1f9a1c2)

## [busted](https://lunarmodules.github.io/busted/#overview)

The most widely used Lua test framework.

Syntax could be lighten with [Moonscript](https://lunarmodules.github.io/busted/#moonscript). ðŸš§

### Setup
{% highlight bash %}
$ sudo apt-get install luarocks
$ sudo apt install liblua5.2-dev  # depending on lua -v
$ sudo luarocks install busted
$ busted --version # validate
{% endhighlight %}

### Example

{% highlight lua %}
describe("math", function()
  it("adds numbers correctly", function()
    assert.is_equal(4, 2 + 2)
  end)
end)
{% endhighlight %}

Then run with
{% highlight bash %}
$ busted . # By default, it looks for *_spec.lua files in your project.
{% endhighlight %}

### VSCode ðŸš§
see Busted Test Explorer by Vivien Henriet

{% highlight bash %}
Busted error: spawn /usr/local/bin/busted ENOENT
Busted exited with code -2
{% endhighlight %}


# see also
- [LuaRocks](https://luarocks.org/) - the package manager for Lua modules.
- [Piccolo â€“ A Stackless Lua Interpreter ](https://kyju.org/blog/piccolo-a-stackless-lua-interpreter/) / [HN](https://news.ycombinator.com/item?id=40239029)
- [Lux](https://mrcjkb.dev/posts/2025-04-07-lux-announcement.html) / [HN](https://news.ycombinator.com/item?id=43614285) - a luxurious package manager for Lua
